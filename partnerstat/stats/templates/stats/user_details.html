{% extends 'base.html' %}

{% load static %}

{% block page_header %}
User details
{% endblock %}

{% block content %}
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css">

<table class="table table-striped table-bordered">
    <tr><td>User name</td><td>{{ result.username }}</td></tr>
    <tr><td>First name</td><td>{{ result.first_name }}</td></tr>
    <tr><td>Last name</td><td>{{ result.last_name }}</td></tr>
    <tr><td>Email</td><td>{{ result.email }}</td></tr>
    <tr><td>Plan</td><td>{{ result.account.plan_name }}</td></tr>
    <tr><td>Plan status</td><td>{{ result.account.verbose_plan_status }}</td></tr>
    <tr><td>Date joined</td><td>{{ date_joined }}</td></tr>
    <tr><td>Last login</td><td>{{ last_login }}</td></tr>
</table>

<table id="example" class="display table table-striped table-bordered" cellspacing="0" width="100%">
    <thead>
        <tr>
            <th>Date, time</th>
            <th>IP</th>
            <th>Name</th>
            <th>Plan</th>
            <th>Bitrate</th>
            <th>Time</th>
        </tr>
    </thead>
</table>

{% endblock %}

{% block custom_scripts %}
<script src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js"></script>

<script>
    $( document ).ready(function() {

        var columnsDef = [
        {
            "title": "Date, time",
            "data": "created_utc",
            "render": function ( data, type, full, meta ) {
                          return '<a href=/stats/users/'+full.id+'>' + data + '</a>';
                        }
         },
                  {
            "title": "IP",
            "data": "client_ip"
         },
         {
            "title": "Name",
            "data": "media_object_name"
         },
      {
            "title": "Plan name",
            "data": "media_packet_name"
         },
               {
            "title": "Bitrate",
            "data": "bitrate_id"
         },
         {
            "title": "Time",
            "data": "played_seconds"
         },
        ]

        $('#example').DataTable( {
            "columns": columnsDef,
            "ordering": false,
            "searching": false,
            "pageLength": 10,
            "processing": true,
            "serverSide": true,
            "ajax": {
                "url": "/stats/views_json?id={{ result.id }}"
            }

        });

    });
</script>

{% endblock %}